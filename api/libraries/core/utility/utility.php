<?php
 defined('BASEPATH') or die; class JUtility { public static function parseAttributes($string) { $attr = array(); $retarray = array(); preg_match_all('/([\w:-]+)[\s]?=[\s]?"([^"]*)"/i', $string, $attr); if (is_array($attr)) { $numPairs = count($attr[1]); for ($i = 0; $i < $numPairs; $i++) { $retarray[$attr[1][$i]] = $attr[2][$i]; } } return $retarray; } public static function generateSignature($httpMethod, $secretKey, $requestPath, $queryParams, $requestBody = "") { $stringToSign = $secretKey . strtoupper($httpMethod); $stringToSign .= $requestPath; ksort($queryParams); foreach($queryParams as $key => $value) { $stringToSign .= $key . "=" . $value; } $stringToSign .= $requestBody; $signature = base64_encode(hash('sha256', $stringToSign, true)); $signature = urlencode(substr($signature, 0, 43)); return rtrim($signature, '='); } }