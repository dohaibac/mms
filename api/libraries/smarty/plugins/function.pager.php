<?php
 function smarty_function_pager($params, &$smarty) { global $conf; $limit = $conf['page_size']; $total = 0; $num = 5; $current_page = 1; $txt_prev = 'Â«'; $txt_next = 'Â»'; if (!empty($params)) { $limit = !empty($params['limit']) ? $params['limit'] : $limit; $total = !empty($params['total']) ? $params['total'] : $total; } if ($total <= $limit) return ''; $total_page = ceil($total / $limit); $uri = JUri::getInstance(); $path = $uri->getPath(); $current_page = $uri->getVar('page'); if (empty($current_page)) $current_page = 1; $start = $current_page - $num < 1 ? 1 : $current_page - $num; $end = $start + $num; if ($end > $total_page) { $end = $total_page; $start = ($end - $num) < 1 ? 1: $end - $num; } if ($total_page <= 1) return ''; $ret = '<ul class="pagination">'; $class = ''; $path = $uri->getPath(); $query = $uri->getQuery(); parse_str($query, $url_params); if (empty($url_params)) { $url_params = array(); } $query = ''; if ($current_page > 1) { $url_params['page'] = $current_page - 1; $query = '?' . $uri->buildQuery($url_params); $ret .= '<li><a href="'. $path . $query .'">' . $txt_prev . '</a></li>'; } for($i = $start; $i<= $end; $i++) { if ($i == $current_page) { $class = ' class="active" '; } else { $class = ''; } $url_params['page'] = $i; $query = '?' . $uri->buildQuery($url_params); $ret .= '<li '. $class .'><a href="'. $path . $query .'">' . $i . '</a></li>'; } if ($current_page < $total_page) { $url_params['page'] = $current_page + 1; $query = '?' . $uri->buildQuery($url_params); $ret .= '<li><a href="'. $path . $query .'">' . $txt_next . '</a></li>'; } $ret .='</ul>'; return $ret; } ?>